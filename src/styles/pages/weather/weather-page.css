/* ===== Weather page (responsive, full-bleed sky, sticky header) ===== */
:root{
  --nav-h: 0px;                   /* your navbar effect sets this */
  --pad-x: clamp(16px, 4vw, 48px);
}

html, body, #root { height: 100%; }
body { margin: 0; }

/* 1) Break out of any fixed-width site wrapper (full viewport width) */
.wx{
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  max-width: none;
}

/* 2) Let the header stack earlier so the search can shrink sooner */
@media (max-width: 1200px){
  .wx__header{ grid-template-columns: 1fr; } /* title on its own row, search full width below */
}

/* Safety: never let children force the grid wider than the viewport */
.wx__header *{ min-width: 0; }
.wx__actions, .wx__search{ width: 100%; max-width: none; }
.wx__search-input{ width: 100%; min-width: 0; box-sizing: border-box; }

/* Full-bleed background container (rendered via portal to <body>) */
.wx-bg{
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  overflow: hidden;
}

/* Gradient (keep ON) */
.wx-bg__gradient{ position:absolute; inset:0; transition:background 600ms ease; }
.wx--sun    .wx-bg__gradient{ background: linear-gradient(180deg,#7ecbff 0%, #ffe79a 55%, #fff 100%); }
.wx--cloud  .wx-bg__gradient{ background: linear-gradient(180deg,#bcd0e0 0%, #9fb1c3 60%, #dcdfe6 100%); }
.wx--cloudSun .wx-bg__gradient{ background: linear-gradient(180deg,#a9d8ff 0%, #d5e0f5 55%, #fff 100%); }
.wx--rain   .wx-bg__gradient,
.wx--drizzle .wx-bg__gradient{ background: linear-gradient(180deg,#8fc5ff 0%, #5aa9ff 55%, #25324a 100%); }
.wx--snow   .wx-bg__gradient{ background: linear-gradient(180deg,#eaf6ff 0%, #cfeaff 55%, #ffffff 100%); }
.wx--storm  .wx-bg__gradient{ background: linear-gradient(180deg,#374a74 0%, #232a4a 60%, #17182d 100%); }
.wx--fog    .wx-bg__gradient{ background: linear-gradient(180deg,#dfe6ee 0%, #c7cfd8 60%, #e8edf2 100%); }

/* Clouds */
.wx-bg__clouds { position:absolute; inset:-10% -30% 0 -30%; opacity:.8; }
.wx-bg__clouds::before, .wx-bg__clouds::after{
  content:""; position:absolute; inset:0;
  background:
    radial-gradient(180px 70px at 15% 20%, rgba(255,255,255,.9) 0 70%, transparent 71%),
    radial-gradient(220px 80px at 40% 30%, rgba(255,255,255,.85) 0 70%, transparent 71%),
    radial-gradient(200px 80px at 70% 28%, rgba(255,255,255,.9) 0 70%, transparent 71%),
    radial-gradient(180px 70px at 90% 25%, rgba(255,255,255,.85) 0 70%, transparent 71%);
  filter: blur(6px);
  transform: translateX(-10%);
  animation: cloudDrift 60s linear infinite;
}
.wx-bg__clouds::after{ opacity:.7; transform: translateX(-40%) translateY(12%); animation-duration: 85s; }
@keyframes cloudDrift{ 0%{ transform: translateX(-40%);} 100%{ transform: translateX(20%);} }
.wx--sun   .wx-bg__clouds{ opacity:.18; }
.wx--storm .wx-bg__clouds{ opacity:.35; }

/* Rain */
.wx-bg__rain{ position:absolute; inset:-18% -10%; opacity:0;
  -webkit-mask-image: linear-gradient(to bottom, transparent, black 12%, black 88%, transparent);
          mask-image: linear-gradient(to bottom, transparent, black 12%, black 88%, transparent);
}
.wx-bg__rain::before, .wx-bg__rain::after{ content:""; position:absolute; inset:0; background-repeat: repeat; will-change: transform; }
.wx-bg__rain::before{
  background-image: linear-gradient(120deg, rgba(255,255,255,.35) 1px, rgba(255,255,255,0) 3px);
  background-size: 14px 24px; filter: blur(.2px);
  animation: wxRainA 1.15s linear infinite;
}
.wx-bg__rain::after{
  background-image: linear-gradient(120deg, rgba(255,255,255,.25) 1px, rgba(255,255,255,0) 2px);
  background-size: 10px 18px; opacity:.85; transform: translateX(2%);
  animation: wxRainB 0.95s linear infinite;
}
@keyframes wxRainA{ 0%{ transform: translate3d(0,-12%,0);} 100%{ transform: translate3d(-2%,12%,0);} }
@keyframes wxRainB{ 0%{ transform: translate3d(0,-12%,0);} 100%{ transform: translate3d(-1%,12%,0);} }
.wx--drizzle .wx-bg__rain{ opacity:.35; }
.wx--rain    .wx-bg__rain{ opacity:.55; }
.wx--storm   .wx-bg__rain{ opacity:.65; }

/* Snow */
.wx-bg__snow{ position:absolute; inset:0; opacity:0; }
.wx-bg__snow::before, .wx-bg__snow::after{
  content:""; position:absolute; inset:-10% 0 auto 0; height:120%;
  background:
    radial-gradient(2px 2px at 20% 10%, rgba(255,255,255,.9) 98%, transparent 100%),
    radial-gradient(2px 2px at 60% 30%, rgba(255,255,255,.9) 98%, transparent 100%),
    radial-gradient(2px 2px at 80% 15%, rgba(255,255,255,.9) 98%, transparent 100%),
    radial-gradient(2px 2px at 35% 40%, rgba(255,255,255,.9) 98%, transparent 100%),
    radial-gradient(2px 2px at 10% 60%, rgba(255,255,255,.9) 98%, transparent 100%),
    radial-gradient(2px 2px at 75% 55%, rgba(255,255,255,.9) 98%, transparent 100%);
  animation: snowFall 10s linear infinite;
}
.wx-bg__snow::after{ opacity:.7; animation-duration: 14s; }
@keyframes snowFall{ 0%{ transform: translateY(-8%);} 100%{ transform: translateY(8%);} }
.wx--snow .wx-bg__snow{ opacity:.8; }

/* Lightning */
.wx-bg__flash{
  position:absolute; inset:0;
  background: radial-gradient(60% 40% at 60% 10%, rgba(255,255,255,.9), transparent 60%);
  mix-blend-mode: screen; opacity:0;
  animation: flash 14s linear infinite;
}
@keyframes flash{ 0%,96%,100%{opacity:0;} 97%{opacity:.85;} 98.5%{opacity:0;} 99%{opacity:.65;} }
.wx--storm .wx-bg__flash{ opacity:1; }

/* Fog */
.wx-bg__fog{
  position:absolute; inset:0; opacity:0;
  background:
    linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,0) 30%),
    linear-gradient(0deg, rgba(255,255,255,.55), rgba(255,255,255,0) 30%);
}
.wx--fog .wx-bg__fog{ opacity:.75; }

/* Weather container + layout */
.wx{ position: relative; min-height: 100dvh; isolation: isolate; }

/* Sticky header (responsive) */
.wx__header{
  position: sticky;
  top: var(--nav-h);
  z-index: 1100;

  margin: 0 var(--pad-x);
  padding: 10px 12px;

  display: grid;
  grid-template-columns: 1fr minmax(240px, 520px);
  align-items: center;
  gap: 16px;
  box-sizing: border-box;

  background: rgba(12,14,20,.78);
  color: #eaf2ff;
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 14px;
  box-shadow: 0 12px 30px rgba(0,0,0,.25);
  backdrop-filter: blur(8px);
}
.wx__header *{ min-width: 0; }

.wx__content{ position: relative; z-index: 1; padding: 16px var(--pad-x) 80px; }

/* header/content safe areas & robustness */
.wx__header{
  padding-bottom: max(10px, env(safe-area-inset-top, 0));
}
.wx__content{
  padding-bottom: max(72px, env(safe-area-inset-bottom, 0));
}

/* never let children force the grid wider than viewport */
.wx__header *{
  min-width: 0;
}
.wx__actions, .wx__search{
  width: 100%;
  max-width: none;
}
.wx__search-input{
  width: 100%;
  min-width: 0;
  box-sizing: border-box;
}

/* Search */
.wx__actions{ display:flex; align-items:center; gap:8px; width:100%; }
.wx__search{ position:relative; display:flex; width:100%; max-width:520px; }
.wx__search-input{
  width:100%; height:40px; box-sizing:border-box;
  padding:0 40px 0 14px; font-size:16px;
  border-radius:8px; border:2px solid #000; background:#fff; color:#111;
}
.wx__search-btn{
  position:absolute; right:8px; top:50%; transform:translateY(-50%);
  border:0; background:transparent; cursor:pointer;
}
.wx__search-list{
  position:absolute; top:calc(100% + 8px); left:0; right:0;
  z-index:1300; margin:0; padding:6px 0; list-style:none;
  background:#fff; border:1px solid #ddd; border-radius:12px;
  max-height:320px; overflow:auto; box-shadow:0 10px 30px rgba(0,0,0,.1);
}
.wx__search-item{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px 12px; cursor:pointer; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.wx__search-item:hover{ background:#f6f7f9; }
.wx__search-name{ font-weight:600; color:#111; overflow:hidden; text-overflow:ellipsis; }
.wx__search-meta{ color:#666; flex:0 0 auto; }

.wx__save-btn{
  height:40px; padding:0 12px; border-radius:8px; white-space:nowrap;
  border:1px solid rgba(255,255,255,.16);
  background:rgba(0,0,0,.30); color:#fff; backdrop-filter:blur(6px);
}
.wx__save-btn:hover{ background:rgba(0,0,0,.4); }

/* Header stacks on narrow screens */
@media (max-width: 900px){
  .wx__header{ grid-template-columns: 1fr; row-gap:10px; }
  .wx__actions, .wx__search{ width:100%; max-width:none; }
}

@media (max-width: 640px){
  .wx__content{ padding: 12px var(--pad-x) 72px; }
}

.wx__search-name{
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  min-width: 0;
}

@media (max-width: 420px){
  .wx__search-input { height: 38px; font-size: 15px; }
  .wx__save-btn     { height: 38px; padding: 0 10px; }
}

@media (prefers-reduced-motion: reduce){
  .wx-bg__clouds, .wx-bg__clouds::before, .wx-bg__clouds::after,
  .wx-bg__rain, .wx-bg__snow::before, .wx-bg__snow::after,
  .wx-bg__flash { animation: none !important; }
}
